---
import { Image } from "astro:assets";
import BaseLayout from "./BaseLayout.astro";
import { type Locale, t } from "../i18n";

type Hero = {
  image: ImageMetadata;
  alt: string;
};

type ListItem = string | { label: string; text: string };

type Section =
  | { title: string; kind: "text"; body: string }
  | { title: string; kind: "list"; items: ListItem[] };

export interface Props {
  title: string;
  description: string;
  lang: Locale;
  hero?: Hero;
  lead: string;
  sections: Section[];
  benefitsTitle?: string;
  benefits: string[];
  aside: {
    label: string;
    text: string;
  };
  cta: {
    href: string;
    label: string;
  };
}

const {
  title,
  description,
  lang,
  hero,
  lead,
  sections,
  benefitsTitle,
  benefits,
  aside,
  cta,
} = Astro.props;

const finalBenefitsTitle = benefitsTitle || t('serviceLayout.benefitsTitle', lang);
---

<BaseLayout title={`${title} | Evelin Valcarce`} description={description} lang={lang}>
  {hero && (
    <section aria-label="Illustration" class="pt-20">
      <div class="w-full overflow-hidden bg-gray-100">
        <div style="aspect-ratio: 21 / 9;">
          <Image
            src={hero.image}
            alt={hero.alt}
            class="h-full w-full object-cover"
            loading="eager"
            decoding="async"
            widths={[480, 768, 1024, 1280, 1600]}
            sizes="100vw"
          />
        </div>
      </div>
    </section>
  )}

  <article class="py-16">
    <div class="mx-auto w-full max-w-4xl px-4 sm:px-6 lg:px-8">
      <h1 class="mb-8 font-serif text-4xl text-gray-800 sm:text-5xl">{title}</h1>
      <p class="mb-10 text-xl leading-relaxed text-gray-600 text-justify">{lead}</p>

      {sections.map((s) => (
        <section class="mt-12">
          <h2 class="mb-6 font-serif text-3xl text-gray-800">{s.title}</h2>

          {s.kind === "text" ? (
            <p class="leading-relaxed text-gray-700 text-justify">{s.body}</p>
          ) : (
            <ul class="list-none space-y-2 leading-relaxed text-gray-700">
              {s.items.map((item) => (
                <li>
                  {typeof item === "string" ? (
                    item
                  ) : (
                    <>
                      <strong class="text-inherit">{item.label}</strong> {item.text}
                    </>
                  )}
                </li>
              ))}
            </ul>
          )}
        </section>
      ))}

      <section class="mt-12" aria-label={finalBenefitsTitle}>
        <h2 class="font-serif text-3xl text-gray-800 mb-6">
          {finalBenefitsTitle}
        </h2>
        <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
          {benefits.map((benefit) => (
            <li class="flex items-start gap-3 bg-gray-50 p-4 rounded-lg border border-gray-100">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-rose-400 shrink-0 w-5 h-5 mt-1" aria-hidden="true">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <path d="m9 11 3 3L22 4"/>
              </svg>
              <span class="text-base">{benefit}</span>
            </li>
          ))}
        </ul>
      </section>

      <aside class="mt-12 rounded-r-xl border-l-4 border-rose-400 bg-rose-50 p-6">
        <p class="leading-relaxed text-gray-700 text-justify">
          <strong class="text-rose-700 font-bold">{aside.label}</strong>
          {aside.text}
        </p>
      </aside>

      <div class="mt-16 text-center">
        <button
          type="button"
          data-open-modal="appointment"
          class="inline-flex items-center justify-center rounded-full bg-rose-400 px-10 py-4 text-lg text-white transition-colors hover:bg-rose-500 
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-400 focus-visible:ring-offset-2"
        >
          {cta.label}
        </button>
      </div>
    </div>
  </article>
</BaseLayout>