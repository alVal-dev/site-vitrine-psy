---
import { locales, localeLabels, type Locale, getAlternateUrl } from "../../i18n";

interface Props {
  lang: Locale;
  class?: string;
}

const { lang, class: className = "" } = Astro.props;
const currentPath = Astro.url.pathname;
---

<nav class={`flex items-center gap-2 ${className}`} aria-label="Langue">
  {locales.map((locale) => {
    const isActive = locale === lang;
    const href = getAlternateUrl(currentPath, locale);
    
    return (
      <a
        href={href}
        class:list={[
          "w-6 h-4 rounded-sm overflow-hidden border border-gray-300 transition-all",
          isActive
            ? "ring-2 ring-rose-400 ring-offset-1"
            : "opacity-50 hover:opacity-100"
        ]}
        aria-current={isActive ? "page" : undefined}
        aria-label={localeLabels[locale]}
        title={localeLabels[locale]}
      >
        {locale === 'fr' ? (
          <span class="flex h-full" aria-hidden="true">
            <span class="w-1/3 bg-[#002395]"></span>
            <span class="w-1/3 bg-white"></span>
            <span class="w-1/3 bg-[#ED2939]"></span>
          </span>
        ) : (
          <span class="flex flex-col h-full" aria-hidden="true">
            <span class="h-1/4 bg-[#C60B1E]"></span>
            <span class="h-2/4 bg-[#FFC400]"></span>
            <span class="h-1/4 bg-[#C60B1E]"></span>
          </span>
        )}
      </a>
    );
  })}
</nav>